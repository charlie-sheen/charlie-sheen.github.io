{"version":3,"sources":["js/node_modules/browserify/node_modules/browser-pack/_prelude.js","js/index.js"],"names":[],"mappings":"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","file":"js/index.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","const canvas = document.querySelector('.output-canvas');\nconst hiddenCanvas = document.querySelector('.hidden-canvas');\nconst button = document.querySelector('.real-btn');\nconst fakeButton = document.querySelector('.upload-btn');\nconst downloadLink = document.querySelector('.download');\n\nconst ctx = canvas.getContext('2d');\nconst hiddenCtx = hiddenCanvas.getContext('2d');\n\nconst overlayImg = new Image();\n\nfunction drawImageScaled(img, thisCtx) {\n  const thisCanvas = thisCtx.canvas;\n  const hRatio = thisCanvas.width / img.width;\n  const vRatio = thisCanvas.height / img.height;\n  const ratio = Math.max(hRatio, vRatio);\n  const centerShift_x = (thisCanvas.width - img.width * ratio) / 2;\n  const centerShift_y = (thisCanvas.height - img.height * ratio) / 2; \n\n  thisCtx.clearRect(0, 0, thisCanvas.width, thisCanvas.height);\n  thisCtx.drawImage(\n    img, \n    0,\n    0, \n    img.width, \n    img.height,\n    centerShift_x,\n    centerShift_y,\n    img.width * ratio, \n    img.height * ratio\n  );  \n}\n\nfunction loadImage(img) {\n  return new Promise((resolve, reject) => {\n    img.onload = () => {\n      return resolve(img);\n    };\n\n    img.onerror = (err) => {\n      return reject(err);\n    };\n  });\n}\n\nfakeButton.onclick = () => {\n  button.click();\n};\n\nbutton.onchange = () => {\n  if (typeof window.FileReader !== 'function' || !button.files) {\n    window.alert(\"Sorry. Your browser is old and/or terrible\");\n    return;\n  } else if (!button.files[0]) {\n    window.alert(\"Please select a file before clicking 'Load'\");\n  }\n  else {\n    let file = button.files[0];\n    let fr = new FileReader();\n\n    Promise.all([\n      loadImage(overlayImg),\n      loadImage(fr)\n    ]).then(imgArr => {\n      let overlay = imgArr[0];\n      let main = imgArr[1].result;\n      let overlayData = '';\n      let newOverlayImg;\n      let mainImg;\n\n      mainImg = new Image();\n      newOverlayImg = new Image();\n      mainImg.src = main;\n\n      mainImg.onload = () => {\n        canvas.height = mainImg.height;\n        canvas.width = mainImg.width;\n        hiddenCanvas.height = canvas.height;\n        hiddenCanvas.width = canvas.width;\n\n        hiddenCtx.globalAlpha = 0.4;\n        drawImageScaled(overlay, hiddenCtx);\n        hiddenCtx.globalAlpha = 1.0;\n\n        overlayData = hiddenCanvas.toDataURL();\n\n        ctx.drawImage(mainImg, 0, 0);\n\n        newOverlayImg.onload = () => {\n          ctx.drawImage(newOverlayImg, 0, 0);\n\n          downloadLink.href = canvas.toDataURL('image/jpeg');\n          downloadLink.className = 'download';\n        };\n\n        newOverlayImg.src = overlayData;\n      };\n    }); \n\n    fr.readAsDataURL(file);\n\n    overlayImg.crossOrigin = 'Anonymous';\n    overlayImg.src = '../img/sheen.jpg';\n  }\n};"]}